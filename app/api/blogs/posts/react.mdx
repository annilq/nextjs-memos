---
title: build your own react
date: 2018-05-04 15:48:15
tags: react
---
### å…ˆä¸Šreact.jså°ä¹¦å…³äºå‰ç«¯ç»„ä»¶çš„ä»£ç 
```javascript
const createDOMFromString = (domString) => {
  const div = document.createElement('div')
  div.innerHTML = domString
  return div
}
class Component {
    setState (state) {
      const oldEl = this.el
      this.state = state
      this._renderDOM()
      if (this.onStateChange) this.onStateChange(oldEl, this.el)
    }

    _renderDOM () {
      this.el = createDOMFromString(this.render())
      return this.el
    }
  }
 class LikeButton extends Component {
    constructor (props) {
      super(props)
      this.state = { isLiked: false }
    }

    onClick () {
      this.setState({
        isLiked: !this.state.isLiked
      })
    }

    render () {
      return `
        <button class='like-btn' style="background-color: ${this.props.bgColor}">
          <span class='like-text'>
            ${this.state.isLiked ? 'å–æ¶ˆ' : 'ç‚¹èµ'}
          </span>
          <span>ğŸ‘</span>
        </button>
      `
    }
  }
const mount = (component, wrapper) => {
    wrapper.appendChild(component._renderDOM())
    component.onStateChange = (oldEl, newEl) => {
      wrapper.insertBefore(newEl, oldEl)
      wrapper.removeChild(oldEl)
    }
  }
mount(new LikeButton({ bgColor: 'red' }), wrapper)
```
#### ä»£ç è¯´æ˜
1. ```createDOMFromString```æ–¹æ³•ç”¨äºå°†domå­—ç¬¦ä¸²è½¬æˆdom
2. ```mount```æ–¹æ³•ç”¨äºå°†ç»„ä»¶ä¸é¡µé¢çš„domå…ƒç´ ```wrapper```åˆå§‹åŒ–å…³è”
    1. ```onStateChange```åº”è¯¥è®¾ç½®å®ä¾‹ç»„ä»¶ä¸Šé¢
3. é¦–å…ˆå…¬å…±çš„éƒ¨åˆ†æŠ½è±¡æˆä¸€ä¸ªcomponentç»„ä»¶ï¼Œå…¶ä¸­åŒ…æ‹¬ä¸¤ä¸ªæ–¹æ³•
    1. ```setState```å­ç»„ä»¶è°ƒç”¨æ—¶ï¼Œæ ¹æ®stateé‡æ–°æ¸²æŸ“ç»„ä»¶
    2. ```_renderDOM``` æ ¹æ®stateå˜åŒ–è°ƒç”¨```render```æ–¹æ³•é‡æ–°æ¸²æŸ“ç»„ä»¶
    3. å®ä¾‹ç»„ä»¶å¿…é¡»æœ‰å®ä¾‹```render```æ–¹æ³•ç”¨äºçˆ¶ç»„ä»¶è°ƒç”¨

#### å‚è€ƒ
1. [React in 160 lines of JavaScript](https://medium.com/@sweetpalma/gooact-react-in-160-lines-of-javascript-44e0742ad60f)
2. [React.js å°ä¹¦](http://huziketang.mangojuice.top/books/react/)
